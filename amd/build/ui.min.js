define("tiny_chemdraw/ui",["exports","core/str","core/templates","core/modal","core/config","core/notification"],(function(_exports,_str,_templates,_modal,_config,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Commands helper for the Moodle tiny_chemdraw plugin.
   *
   * @module      plugintype_pluginname/ui
   * @copyright   2024 Aniket Kumar <aniketkj9211@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.insert=_exports.ChemEmbed=void 0,_templates=_interopRequireDefault(_templates),_modal=_interopRequireDefault(_modal),_config=_interopRequireDefault(_config);_exports.ChemEmbed=class{editor=null;constructor(editor){this.editor=editor}loadResource=async(url,type)=>new Promise(((resolve,reject)=>{const element="script"===type?document.createElement("script"):document.createElement("link");element.onload=resolve,element.onerror=()=>reject(new Error(`Failed to load ${type}: ${url}`)),"stylesheet"===type?(element.rel="stylesheet",element.href=url):"script"===type&&(element.src=url),document["script"===type?"body":"head"].appendChild(element)}));initializeChemDoodle=()=>{try{ChemDoodle.ELEMENT.H.jmolColor="black",ChemDoodle.ELEMENT.S.jmolColor="#B9A130";const sketcher=new ChemDoodle.SketcherCanvas("sketcher",600,350,{useServices:!1,requireStartingAtom:!1});sketcher.styles.atoms_displayTerminalCarbonLabels_2D=!0,sketcher.styles.atoms_useJMOLColors=!0,sketcher.styles.bonds_clearOverlaps_2D=!0,sketcher.styles.shapes_color="#c10000",sketcher.repaint();const sketcherViewer=new ChemDoodle.ViewerCanvas("sketcher-viewer-atto",100,100);sketcherViewer.emptyMessage="No data loaded",sketcherViewer.styles.atoms_displayTerminalCarbonLabels_2D=!0,sketcherViewer.styles.atoms_useJMOLColors=!0,sketcherViewer.styles.bonds_clearOverlaps_2D=!0,sketcher.oldFunc=sketcher.checksOnAction,sketcher.checksOnAction=function(force){this.oldFunc(force);let mols=sketcher.molecules,forms=sketcher.shapes;sketcherViewer.loadContent(mols,forms),sketcher.center();for(let i=0,ii=this.molecules.length;i<ii;i++)this.molecules[i].check()}}catch(error){console.error("Error:",error.message)}};init=async()=>{try{const modal=await _modal.default.create({title:(0,_str.get_string)("sketchtitle"),show:!0,removeOnClose:!0});_templates.default.renderForPromise("tiny_chemdraw/chemTemplate",{}).then((async _ref=>{let{html:html,js:js}=_ref;_templates.default.appendNodeContents(modal.getBody(),html,js);const resources=[`${_config.default.wwwroot}/lib/editor/tiny/plugins/chemdraw/ChemDoodle/install/ChemDoodleWeb.css`,`${_config.default.wwwroot}/lib/editor/tiny/plugins/chemdraw/ChemDoodle/install/uis/jquery-ui-1.11.4.css`,`${_config.default.wwwroot}/lib/editor/tiny/plugins/chemdraw/ChemDoodle/install/ChemDoodleWeb.js`,`${_config.default.wwwroot}/lib/editor/tiny/plugins/chemdraw/ChemDoodle/install/uis/ChemDoodleWeb-uis.js`,`${_config.default.wwwroot}/lib/editor/tiny/plugins/chemdraw/chem/chem.css`],types=["stylesheet","stylesheet","script","script","stylesheet"];for(let i=0;i<resources.length;i++)await this.loadResource(resources[i],types[i]);window.parent.document.querySelector(".modal-dialog").style.maxWidth="850px",this.initializeChemDoodle()}))}catch(error){(0,_notification.exception)(error)}}};_exports.insert=()=>{let src=ChemDoodle.io.png.string(sketcherViewer),mol=sketcherViewer.getMolecule(),molFile=ChemDoodle.writeMOL(mol);if(window.parent.tinyMCE&&window.parent.tinyMCE.activeEditor){var content='<img src="'+src+'"';window.parent.tinyMCE.activeEditor.execCommand("mceInsertContent",0,content),window.parent.tinyMCE.activeEditor.execCommand("mceInsertContent",0,"\x3c!--"+molFile+"--\x3e"),window.parent.document.querySelector(".modal").querySelector(".close").click()}console.log("button Click")}}));

//# sourceMappingURL=ui.min.js.map